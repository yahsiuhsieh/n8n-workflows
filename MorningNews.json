{
  "active": false,
  "activeVersion": null,
  "activeVersionId": null,
  "connections": {
    "GetPast24Hours": {
      "main": [
        [
          {
            "node": "FilterBaseOnTime",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "FilterBaseOnTime": {
      "main": [
        [
          {
            "node": "Get10NewsForEachField",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google News Finance": {
      "main": [
        [
          {
            "node": "SetFinanceField",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "TechCrunch": {
      "main": [
        [
          {
            "node": "SetTechField",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google News World": {
      "main": [
        [
          {
            "node": "SetWorldNewsField",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google News US": {
      "main": [
        [
          {
            "node": "SetUsNewsField",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google News Business": {
      "main": [
        [
          {
            "node": "SetBusinessField",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "MergeAllRSS": {
      "main": [
        [
          {
            "node": "RemoveDuplicates",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "AggregateToList": {
      "main": [
        [
          {
            "node": "OrganizeData",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Decoded url": {
      "main": [
        [
          {
            "node": "SetValues",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Call decoding URL": {
      "main": [
        [
          {
            "node": "Decoded url",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Prepare decoding variables": {
      "main": [
        [
          {
            "node": "Call decoding URL",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Get encoded news URL": {
      "main": [
        [
          {
            "node": "Extract decoding keys",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Map needed keys": {
      "main": [
        [
          {
            "node": "Prepare decoding variables",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Extract decoding keys": {
      "main": [
        [
          {
            "node": "Map needed keys",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SetFinanceField": {
      "main": [
        [
          {
            "node": "MergeAllRSS",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "SetTechField": {
      "main": [
        [
          {
            "node": "MergeAllRSS",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SetWorldNewsField": {
      "main": [
        [
          {
            "node": "MergeAllRSS",
            "type": "main",
            "index": 2
          }
        ]
      ]
    },
    "SetBusinessField": {
      "main": [
        [
          {
            "node": "MergeAllRSS",
            "type": "main",
            "index": 3
          }
        ]
      ]
    },
    "SetUsNewsField": {
      "main": [
        [
          {
            "node": "MergeAllRSS",
            "type": "main",
            "index": 4
          }
        ]
      ]
    },
    "Get10NewsForEachField": {
      "main": [
        [
          {
            "node": "If",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SetValues": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "RemoveDuplicates": {
      "main": [
        [
          {
            "node": "GetPast24Hours",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Basic LLM Chain": {
      "main": [
        [
          {
            "node": "SendEmail",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "SendErrorMsg",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Google Gemini Chat Model": {
      "ai_languageModel": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "ai_languageModel",
            "index": 0
          }
        ]
      ]
    },
    "If": {
      "main": [
        [
          {
            "node": "Get encoded news URL",
            "type": "main",
            "index": 0
          }
        ],
        [
          {
            "node": "SetValues1",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Merge": {
      "main": [
        [
          {
            "node": "AggregateToList",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "SetValues1": {
      "main": [
        [
          {
            "node": "Merge",
            "type": "main",
            "index": 1
          }
        ]
      ]
    },
    "OrganizeData": {
      "main": [
        [
          {
            "node": "Basic LLM Chain",
            "type": "main",
            "index": 0
          }
        ]
      ]
    },
    "Schedule Trigger": {
      "main": [
        [
          {
            "node": "Google News World",
            "type": "main",
            "index": 0
          },
          {
            "node": "Google News Finance",
            "type": "main",
            "index": 0
          },
          {
            "node": "TechCrunch",
            "type": "main",
            "index": 0
          },
          {
            "node": "Google News Business",
            "type": "main",
            "index": 0
          },
          {
            "node": "Google News US",
            "type": "main",
            "index": 0
          }
        ]
      ]
    }
  },
  "createdAt": "2025-12-17T21:16:44.965Z",
  "description": null,
  "id": "7hJz5eQk12axtKwc",
  "isArchived": false,
  "meta": {
    "templateCredsSetupCompleted": true
  },
  "name": "MorningNews",
  "nodes": [
    {
      "parameters": {
        "operation": "subtractFromDate",
        "magnitude": "={{ $now }}",
        "timeUnit": "hours",
        "duration": 24,
        "outputFieldName": "Past24Hours",
        "options": {}
      },
      "type": "n8n-nodes-base.dateTime",
      "typeVersion": 2,
      "position": [
        896,
        384
      ],
      "id": "773a18c2-0f78-4671-9b24-7818520c2b22",
      "name": "GetPast24Hours"
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "db1058b7-e03e-4e73-970b-687a1325c756",
              "leftValue": "={{ $('RemoveDuplicates').item.json.isoDate.toDateTime().toLocal() }}",
              "rightValue": "={{ $json.Past24Hours }}",
              "operator": {
                "type": "dateTime",
                "operation": "after"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.filter",
      "typeVersion": 2.2,
      "position": [
        1120,
        384
      ],
      "id": "51cbc469-44a5-4075-ad0c-4dfb6eaeee80",
      "name": "FilterBaseOnTime"
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/topics/CAAqIQgKIhtDQkFTRGdvSUwyMHZNREpmTjNRU0FtVnVLQUFQAQ?hl=en-US&gl=US&ceid=US%3Aen",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        0,
        192
      ],
      "id": "22dfceb1-8614-48de-9916-7b424daf726a",
      "name": "Google News Finance"
    },
    {
      "parameters": {
        "url": "https://techcrunch.com/feed/",
        "options": {}
      },
      "id": "401f58bd-6aad-4f45-9dc2-7dd0f62524a3",
      "name": "TechCrunch",
      "type": "n8n-nodes-base.rssFeedRead",
      "position": [
        0,
        0
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/topics/CAAqJggKIiBDQkFTRWdvSUwyMHZNRGx1YlY4U0FtVnVHZ0pWVXlnQVAB?hl=en-US&gl=US&ceid=US%3Aen",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        0,
        384
      ],
      "id": "410dae7f-3b29-4d70-9771-9f7934b05748",
      "name": "Google News World"
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/topics/CAAqIggKIhxDQkFTRHdvSkwyMHZNRGxqTjNjd0VnSmxiaWdBUAE?hl=en-US&gl=US&ceid=US%3Aen",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        0,
        768
      ],
      "id": "fb429791-698a-4f97-b259-f1b8e8c5a213",
      "name": "Google News US"
    },
    {
      "parameters": {
        "url": "https://news.google.com/rss/topics/CAAqJggKIiBDQkFTRWdvSUwyMHZNRGx6TVdZU0FtVnVHZ0pWVXlnQVAB?hl=en-US&gl=US&ceid=US%3Aen",
        "options": {}
      },
      "type": "n8n-nodes-base.rssFeedRead",
      "typeVersion": 1.2,
      "position": [
        0,
        576
      ],
      "id": "16f85777-ff07-4cc2-b1b6-4538d8b7c54c",
      "name": "Google News Business"
    },
    {
      "parameters": {
        "numberInputs": 5
      },
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        448,
        336
      ],
      "id": "4b8a34c3-f72a-4b24-920a-964a83558e11",
      "name": "MergeAllRSS"
    },
    {
      "parameters": {
        "aggregate": "aggregateAllItemData",
        "options": {}
      },
      "type": "n8n-nodes-base.aggregate",
      "typeVersion": 1,
      "position": [
        1280,
        1136
      ],
      "id": "5c7e692a-bd32-44ad-9dc5-a67f7c152d7f",
      "name": "AggregateToList"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "c51f320e-4fb8-4bd4-8e36-9330e251936e",
              "name": "url",
              "type": "string",
              "value": "={{ JSON.parse(JSON.parse($json.data.split('\\n\\n')[1])[0][2])[1] }}"
            }
          ]
        },
        "options": {}
      },
      "id": "e5ecb852-583c-485b-b088-b324169c2055",
      "name": "Decoded url",
      "type": "n8n-nodes-base.set",
      "position": [
        2016,
        816
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "method": "POST",
        "url": "https://news.google.com/_/DotsSplashUi/data/batchexecute",
        "sendHeaders": true,
        "headerParameters": {
          "parameters": [
            {
              "name": "Content-Type",
              "value": "application/x-www-form-urlencoded;charset=UTF-8"
            },
            {
              "name": "User-Agent",
              "value": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/129.0.0.0 Safari/537.36"
            },
            {
              "name": "Referer",
              "value": "https://www.google.com/"
            }
          ]
        },
        "sendBody": true,
        "contentType": "form-urlencoded",
        "bodyParameters": {
          "parameters": [
            {
              "name": "f.req",
              "value": "={{ $json.f_req }}"
            }
          ]
        },
        "options": {
          "response": {
            "response": {
              "fullResponse": true,
              "responseFormat": "text"
            }
          }
        }
      },
      "id": "d2f9416a-d91f-42c6-a6f8-522cfd66b3df",
      "name": "Call decoding URL",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        1792,
        816
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "jsCode": "return $input.all().map(item => {\n    const gn_art_id = item.json.base64Str;\n    const timestamp = item.json.timestamp;\n    const signature = item.json.signature;\n\n    const articlesReq = [\n        'Fbv4je',\n        `[\"garturlreq\",[[\"X\",\"X\",[\"X\",\"X\"],null,null,1,1,\"US:en\",null,1,null,null,null,null,null,0,1],\"X\",\"X\",1,[1,1,1],1,1,null,0,0,null,0],\"${gn_art_id}\",${timestamp},\"${signature}\"]`,\n    ];\n\n    return {\n        json: {\n            f_req: JSON.stringify([[articlesReq]])  // Questo verrÃ  usato nel nodo HTTP Request\n        }\n    };\n});"
      },
      "id": "3898a5a8-f212-49e4-bdb8-989e4d44f965",
      "name": "Prepare decoding variables",
      "type": "n8n-nodes-base.code",
      "position": [
        1568,
        816
      ],
      "typeVersion": 2
    },
    {
      "parameters": {
        "url": "={{ $json.link }}",
        "options": {}
      },
      "id": "057f69fd-347d-4944-89a2-2c27a875112d",
      "name": "Get encoded news URL",
      "type": "n8n-nodes-base.httpRequest",
      "position": [
        896,
        816
      ],
      "typeVersion": 4.2
    },
    {
      "parameters": {
        "content": "## Get encoded content\n\nHere we retrieve HTML content",
        "height": 400,
        "width": 220,
        "color": 3
      },
      "id": "ffeebdd8-0600-4d99-b320-3824a71a9073",
      "name": "Sticky Note4",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        848,
        576
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "b5a11795-2bd1-412f-a215-f7402bece002",
              "name": "signature",
              "type": "string",
              "value": "={{ $json.signature }}"
            },
            {
              "id": "33267283-3ac8-4d65-9a01-c7f154a7d061",
              "name": "timestamp",
              "type": "string",
              "value": "={{ $json.timestamp }}"
            },
            {
              "id": "bff8f19a-30d6-4307-87da-9b98b26cee8b",
              "name": "base64Str",
              "type": "string",
              "value": "={{ $('Get10NewsForEachField').item.json.guid }}"
            }
          ]
        },
        "options": {}
      },
      "id": "7f2b8dc6-5176-4afe-9305-72014112ac12",
      "name": "Map needed keys",
      "type": "n8n-nodes-base.set",
      "position": [
        1344,
        816
      ],
      "typeVersion": 3.4
    },
    {
      "parameters": {
        "operation": "extractHtmlContent",
        "extractionValues": {
          "values": [
            {
              "key": "signature",
              "cssSelector": "div",
              "returnValue": "attribute",
              "attribute": "data-n-a-sg"
            },
            {
              "key": "timestamp",
              "cssSelector": "div",
              "returnValue": "attribute",
              "attribute": "data-n-a-ts"
            }
          ]
        },
        "options": {}
      },
      "id": "20b1fe2c-8c99-4f15-b98c-adfb103f2be8",
      "name": "Extract decoding keys",
      "type": "n8n-nodes-base.html",
      "position": [
        1120,
        816
      ],
      "typeVersion": 1.2
    },
    {
      "parameters": {
        "content": "## Decoding Keys\n\nThe HTML content extracted contains the necessary variables for decoding:\n\n+ signature\n+ timestamp\n+ base64string (already in the URL)",
        "height": 400,
        "width": 220
      },
      "id": "abdb56b3-2e16-4ff3-9472-91723ab22c69",
      "name": "Sticky Note5",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1072,
        576
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## Clean output\n\nMapping variables for easy utilization",
        "height": 400,
        "width": 220
      },
      "id": "ea4676d5-94e2-46c8-822f-901fb5bd3c1a",
      "name": "Sticky Note6",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1296,
        576
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## Preparing Request\n\nDecoding the request requires specific body content. Here, we build it using the decoding keys.",
        "height": 400,
        "width": 220,
        "color": 3
      },
      "id": "0e2d5c96-46a5-4ef3-9b9e-3cbbed6a3ac1",
      "name": "Sticky Note7",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1520,
        576
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## This is decoding step\n\nSending a request to a specific Google decoding URL",
        "height": 400,
        "width": 220,
        "color": 3
      },
      "id": "73931ae2-e922-4595-ae47-4117ccb3719d",
      "name": "Sticky Note8",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1744,
        576
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "content": "## Cleaning URL\n\nGoogle adds some unwanted and random characters at the beginning of the URL",
        "height": 400,
        "width": 220
      },
      "id": "d4e1c177-e172-461e-a729-65f18dfea291",
      "name": "Sticky Note9",
      "type": "n8n-nodes-base.stickyNote",
      "position": [
        1968,
        576
      ],
      "typeVersion": 1
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "48012e23-86ed-4d37-b613-e76857796ab9",
              "name": "link",
              "value": "={{ $json.link }}",
              "type": "string"
            },
            {
              "id": "1a585190-d5f0-4363-a328-5921a31dd3d3",
              "name": "title",
              "value": "={{ $json.title }}",
              "type": "string"
            },
            {
              "id": "b7b0e785-d2a7-43a3-ba9b-bab1261ce0bc",
              "name": "content_snippet",
              "value": "={{ $json.contentSnippet }}",
              "type": "string"
            },
            {
              "id": "9cc9bbfd-35f6-463b-b73f-4b424742e20f",
              "name": "isoDate",
              "value": "={{ $json.isoDate }}",
              "type": "string"
            },
            {
              "id": "e3effc7a-9ec8-4762-abe1-388ac777f9d5",
              "name": "field",
              "value": "finance",
              "type": "string"
            },
            {
              "id": "f791ca34-4d1f-4841-8cc9-239e210d73dd",
              "name": "guid",
              "value": "={{ $json.guid }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        224,
        192
      ],
      "id": "2707a39e-58a3-40c9-91aa-e4e27235daed",
      "name": "SetFinanceField"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "48012e23-86ed-4d37-b613-e76857796ab9",
              "name": "link",
              "value": "={{ $json.link }}",
              "type": "string"
            },
            {
              "id": "1a585190-d5f0-4363-a328-5921a31dd3d3",
              "name": "title",
              "value": "={{ $json.title }}",
              "type": "string"
            },
            {
              "id": "b7b0e785-d2a7-43a3-ba9b-bab1261ce0bc",
              "name": "content_snippet",
              "value": "={{ $json.contentSnippet }}",
              "type": "string"
            },
            {
              "id": "a0252fe9-02a1-41f8-934e-1b8106fe23a5",
              "name": "isoDate",
              "value": "={{ $json.isoDate }}",
              "type": "string"
            },
            {
              "id": "689df4ae-725c-44cd-9006-aa4cce448ff0",
              "name": "field",
              "value": "tech",
              "type": "string"
            },
            {
              "id": "fffe80c4-4058-4a44-a342-95fafe5bf250",
              "name": "guid",
              "value": "={{ $json.guid }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        224,
        0
      ],
      "id": "33315b0f-b544-4cc7-920e-8e7521ebfada",
      "name": "SetTechField"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "48012e23-86ed-4d37-b613-e76857796ab9",
              "name": "link",
              "value": "={{ $json.link }}",
              "type": "string"
            },
            {
              "id": "1a585190-d5f0-4363-a328-5921a31dd3d3",
              "name": "title",
              "value": "={{ $json.title }}",
              "type": "string"
            },
            {
              "id": "b7b0e785-d2a7-43a3-ba9b-bab1261ce0bc",
              "name": "content_snippet",
              "value": "={{ $json.contentSnippet }}",
              "type": "string"
            },
            {
              "id": "ab9fa209-e9b6-4bfd-9bd8-6cc253336b43",
              "name": "isoDate",
              "value": "={{ $json.isoDate }}",
              "type": "string"
            },
            {
              "id": "c430678c-f9fe-4ebc-bde1-0a6eb6b2c8d1",
              "name": "field",
              "value": "world_news",
              "type": "string"
            },
            {
              "id": "168a437d-2fa1-4f6a-9e9a-64214827c7c6",
              "name": "guid",
              "value": "={{ $json.guid }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        224,
        384
      ],
      "id": "1a2a3d24-6a1c-48ca-8d36-0ed07d9b20d7",
      "name": "SetWorldNewsField"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "48012e23-86ed-4d37-b613-e76857796ab9",
              "name": "link",
              "value": "={{ $json.link }}",
              "type": "string"
            },
            {
              "id": "1a585190-d5f0-4363-a328-5921a31dd3d3",
              "name": "title",
              "value": "={{ $json.title }}",
              "type": "string"
            },
            {
              "id": "b7b0e785-d2a7-43a3-ba9b-bab1261ce0bc",
              "name": "content_snippet",
              "value": "={{ $json.contentSnippet }}",
              "type": "string"
            },
            {
              "id": "1f640f8f-6b79-45ca-8b72-0dcda2c5cd50",
              "name": "isoDate",
              "value": "={{ $json.isoDate }}",
              "type": "string"
            },
            {
              "id": "bcca7f71-26bd-4b52-9608-97c3ef033c19",
              "name": "field",
              "value": "business",
              "type": "string"
            },
            {
              "id": "579d8a9e-71a6-4476-ae1b-33c92d8e6608",
              "name": "guid",
              "value": "={{ $json.guid }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        224,
        576
      ],
      "id": "27f29928-52ff-486f-bfcf-173411aaa305",
      "name": "SetBusinessField"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "48012e23-86ed-4d37-b613-e76857796ab9",
              "name": "link",
              "value": "={{ $json.link }}",
              "type": "string"
            },
            {
              "id": "1a585190-d5f0-4363-a328-5921a31dd3d3",
              "name": "title",
              "value": "={{ $json.title }}",
              "type": "string"
            },
            {
              "id": "b7b0e785-d2a7-43a3-ba9b-bab1261ce0bc",
              "name": "content_snippet",
              "value": "={{ $json.contentSnippet }}",
              "type": "string"
            },
            {
              "id": "be4de5fb-3970-48e0-9fb8-d221a0a7ded0",
              "name": "isoDate",
              "value": "={{ $json.isoDate }}",
              "type": "string"
            },
            {
              "id": "0558f7fe-4827-4c62-a084-eee996602ff7",
              "name": "field",
              "value": "us_news",
              "type": "string"
            },
            {
              "id": "a028096a-d8e8-47b7-b7a2-c552a132f493",
              "name": "guid",
              "value": "={{ $json.guid }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        224,
        768
      ],
      "id": "21656a4c-2a5c-41c9-801c-1cdedbb93fcd",
      "name": "SetUsNewsField"
    },
    {
      "parameters": {
        "jsCode": "// å–å¹¾ç­†è³‡æ–™\nconst num = 10;\n\n// å–å¾—æ‰€æœ‰è¼¸å…¥çš„ items\nconst items = $(\"MergeAllRSS\").all()\n\n// è¦åˆ†çµ„çš„ field é¡åˆ¥\nconst groups = {};\n\n// åˆ†çµ„ (æŒ‰ç…§ field)\nfor (const item of items) {\n  const field = item.json.field;\n\n  if (!groups[field]) {\n    groups[field] = [];\n  }\n  groups[field].push(item);\n}\n\n// ç‚ºæ¯å€‹ field å–æœ€å¤š 10 ç­†\nlet result = [];\nfor (const field in groups) {\n  const tenItems = groups[field].slice(0, num);\n  result.push(...tenItems);\n}\n\nreturn result;\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1344,
        384
      ],
      "id": "bcf47698-1993-4d8a-a107-f33ceb6dc2ea",
      "name": "Get10NewsForEachField"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "48012e23-86ed-4d37-b613-e76857796ab9",
              "name": "link",
              "value": "={{ $json.url }}",
              "type": "string"
            },
            {
              "id": "1a585190-d5f0-4363-a328-5921a31dd3d3",
              "name": "title",
              "value": "={{ $('Get10NewsForEachField').item.json.title }}",
              "type": "string"
            },
            {
              "id": "b7b0e785-d2a7-43a3-ba9b-bab1261ce0bc",
              "name": "content_snippet",
              "value": "={{ $('Get10NewsForEachField').item.json.content_snippet }}",
              "type": "string"
            },
            {
              "id": "689df4ae-725c-44cd-9006-aa4cce448ff0",
              "name": "field",
              "value": "={{ $('Get10NewsForEachField').item.json.field }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        896,
        1040
      ],
      "id": "0170190c-0a93-4c4b-a6f7-4aeeb654b319",
      "name": "SetValues"
    },
    {
      "parameters": {
        "compare": "selectedFields",
        "fieldsToCompare": "link",
        "options": {}
      },
      "type": "n8n-nodes-base.removeDuplicates",
      "typeVersion": 2,
      "position": [
        672,
        384
      ],
      "id": "202ea358-5e75-4b85-8152-a0388fc429ea",
      "name": "RemoveDuplicates"
    },
    {
      "parameters": {
        "promptType": "define",
        "text": "=ä»¥ä¸‹æ˜¯ä»Šå¤©çš„æ–°èè³‡æ–™ï¼Œè«‹å°‡å…¶è¦–ç‚ºå”¯ä¸€ä¸”å®Œæ•´çš„è³‡æ–™ä¾†æºã€‚\n\n## æ–°èè³‡æ–™\n{{ JSON.stringify($json, null, 2) }}\n\n---\n\n## è³‡æ–™çµæ§‹èªªæ˜ï¼ˆè«‹å‹™å¿…éµå®ˆï¼‰\n\n- æ‰€æœ‰æ–°èå…§å®¹ä½æ–¼ `sections` æ¬„ä½ä¸­ã€‚\n- `sections` æ˜¯ä¸€å€‹ç‰©ä»¶ï¼ˆobjectï¼‰ï¼Œkey ç‚ºæ–°èåˆ†é¡ï¼š\n  - `tech`\n  - `finance`\n  - `business`\n  - `us_news`\n  - `world_news`\n- æ¯å€‹åˆ†é¡çš„ value æ˜¯ä¸€å€‹é™£åˆ—ï¼ˆarrayï¼‰ï¼Œé™£åˆ—ä¸­çš„æ¯ä¸€å€‹å…ƒç´ ä»£è¡¨ä¸€å‰‡æ–°èï¼ŒåŒ…å«ï¼š\n  - `title`\n  - `link`\n  - `snippet`\n  - `source`\n  - `field`\n- `total_items` ä»£è¡¨æ‰€æœ‰åˆ†é¡ä¸­æ–°èçš„ç¸½æ•¸ã€‚\n- è‹¥ `total_items > 0`ï¼Œä»£è¡¨è‡³å°‘å­˜åœ¨ä¸€å‰‡æ–°èï¼Œä¸å¾—å›è¦†ã€Œç„¡å¯ç”¨æ–°èã€ã€‚\n\n---\n\n## èƒŒæ™¯èˆ‡åå¥½ï¼ˆè®€è€…ç•«åƒï¼‰\n\n- è®€è€…æ˜¯ä¸€åå·¥ç¨‹å¸«ï¼ŒåŒæ™‚ä¹Ÿæœ‰åšè‚¡ç¥¨ï¼æŠ•è³‡ã€‚\n- æŠ•è³‡é—œæ³¨ï¼š\n  - è™›æ“¬è²¨å¹£ï¼ˆCryptoï¼‰\n  - ç§‘æŠ€æ¿å¡Šï¼ˆå¤§å‹ç§‘æŠ€ã€åŠå°é«”ã€é›²ç«¯ï¼è³‡æ–™ä¸­å¿ƒã€AI ç”¢æ¥­éˆï¼‰\n  - æœƒå½±éŸ¿é¢¨éšªè³‡ç”¢çš„å®è§€å› ç´ ï¼ˆåˆ©ç‡ã€é€šè†¨ã€ç›£ç®¡ã€é‡å¤§æ”¿ç­–ï¼‰\n- èˆˆè¶£èˆ‡é‡è¦æ€§é †åºï¼ˆè«‹åš´æ ¼éµå®ˆï¼‰ï¼š\n  1. ç§‘æŠ€ï¼ˆTechï¼‰\n  2. è²¡ç¶“ï¼ˆFinanceï¼‰\n  3. å•†æ¥­ï¼ˆBusinessï¼‰\n  4. ç¾åœ‹åœ‹å…§æ–°èï¼ˆUS Newsï¼‰\n  5. ä¸–ç•Œæ–°èï¼ˆWorld Newsï¼‰\n\n---\n\n## ä»»å‹™ï¼ˆé¸é¡Œèˆ‡æ’åºï¼‰\n\n- è«‹éæ­· `sections` ä¸­æ‰€æœ‰åˆ†é¡ä»¥å–å¾—æ–°èã€‚\n- è«‹æ ¹æ“šã€Œå°å·¥ç¨‹å¸« + æŠ•è³‡è€…çš„å¯¦éš›å½±éŸ¿èˆ‡é‡è¦æ€§ã€é¸æ“‡ä¸¦æ’åºæ–°èã€‚\n- å¯ä»¥å¿½ç•¥ä¸é‡è¦æˆ–å½±éŸ¿æœ‰é™çš„æ–°èã€‚\n- æ’åºæ™‚å„ªå…ˆè€ƒé‡ï¼š\n  - ç§‘æŠ€ï¼è³‡å®‰äº‹ä»¶ï¼ˆæ¼æ´ã€è³‡æ–™å¤–æ´©ã€AIã€åŠå°é«”ã€è³‡æ–™ä¸­å¿ƒï¼‰\n  - æŠ•è³‡å½±éŸ¿ï¼ˆåˆ©ç‡ã€é€šè†¨ã€å¤®è¡Œã€Cryptoã€ç§‘æŠ€è‚¡ä¼°å€¼æˆ–è²¡å ±ï¼‰\n  - ç”¢æ¥­è¶¨å‹¢èˆ‡è³‡é‡‘æµå‘\n  - å½±éŸ¿ AIã€åŠå°é«”ã€åŠ å¯†è³‡ç”¢çš„æ”¿ç­–æˆ–ç›£ç®¡\n  - é‡å¤§åœ°ç·£æ”¿æ²»ï¼ˆåƒ…åœ¨å½±éŸ¿å¸‚å ´æˆ–ä¾›æ‡‰éˆæ™‚ç´å…¥ï¼‰\n- è‹¥å¤šå‰‡æ–°èæè¿°åŒä¸€äº‹ä»¶ï¼Œåªä¿ç•™æœ€å…·å…¬ä¿¡åŠ›æˆ–è³‡è¨Šé‡æœ€å¤§çš„ä¸€å‰‡ã€‚\n\n---\n\n## è¼¸å‡ºè¦æ±‚ï¼ˆHTML Emailï¼‰\n\n- å…¨éƒ¨æ¿å¡Šåˆè¨ˆæœ€å¤š **15 å‰‡æ–°è**\n- ç”¢ç”Ÿä»¥ä¸‹çµæ§‹ï¼š\n  1. Headerï¼ˆæ—¥æœŸï¼‰\n  2. ä»Šæ—¥é‡é»æ‘˜è¦ï¼ˆ3â€“5 é»ï¼‰\n  3. åˆ†æ¿å¡Šå…§å®¹ï¼ˆä¾é †åºï¼šTech â†’ Finance â†’ Business â†’ US â†’ Worldï¼‰\n  4. Footer èªªæ˜\n- ã€Œä¾†æºã€å¿…é ˆæ˜¯å¯é»æ“Šé€£çµï¼Œé€£åˆ°åŸæ–‡ã€‚",
        "messages": {
          "messageValues": [
            {
              "message": "ä½ æ˜¯ä¸€ä½å°ˆæ¥­çš„æ–°èç·¨è¼¯ï¼Œè² è²¬ç‚ºä¸€ä½å·¥ç¨‹å¸«å…¼æŠ•è³‡è€…æ’°å¯«ã€Œæ¯æ—¥æ—©æ™¨æ–°èåŒ¯å ±ã€Emailã€‚\n\nè«‹åš´æ ¼éµå®ˆä»¥ä¸‹è¦å‰‡ï¼ˆä¸å¯é•åï¼‰ï¼š\n\n## è³‡æ–™ä½¿ç”¨\n- åƒ…èƒ½ä½¿ç”¨ä½¿ç”¨è€…æä¾›çš„è³‡æ–™ã€‚\n- ä¸å¯åŠ å…¥ä»»ä½•æœªæä¾›çš„äº‹å¯¦ã€èƒŒæ™¯æˆ–æ¨æ¸¬ã€‚\n- è‹¥è³‡è¨Šä¸è¶³ï¼Œè«‹æ˜ç¢ºå¯«ã€Œç„¡æ³•æä¾›è©³æƒ…ã€ã€‚\n\n## è¼¸å‡ºæ ¼å¼ï¼ˆç¡¬æ€§è¦å‰‡ï¼‰\n- è¼¸å‡ºå¿…é ˆæ˜¯ã€Œå®Œæ•´çš„ HTML Emailã€ã€‚\n- å¿…é ˆåŒ…å« <!doctype html>ã€<html>ã€<head>ã€<body>ã€‚\n- åƒ…è¼¸å‡º HTMLï¼Œä¸å¾—è¼¸å‡ºä»»ä½•èªªæ˜æ–‡å­—ã€Markdown æˆ–è¨»è§£ã€‚\n- ä¸å¾—åœ¨ HTML å‰å¾ŒåŠ ä»»ä½•é HTML å…§å®¹ã€‚\n- ä½ å¿…é ˆè¼¸å‡º Tech/Finance/Business/US/World äº”å€‹ sectionï¼ˆè‹¥è©² section æ²’é¸åˆ°æ–°èï¼Œæ•´æ®µç•¥éï¼‰ï¼Œæ¯å€‹ section çš„æ–°èå¡ç‰‡è«‹é‡è¤‡ä½¿ç”¨åŒä¸€æ®µ NEWS CARDã€‚\n\n## æ–°èå‘ˆç¾è¦å‰‡\n- æ¯å‰‡æ–°èå¿…é ˆåŒ…å«ï¼š\n  - æ¨™é¡Œï¼ˆå¯é»æ“Šé€£çµï¼‰\n  - æ‘˜è¦ï¼ˆåƒ…åŸºæ–¼ snippetï¼‰\n  - ç‚ºä½•é‡è¦ï¼ˆ1 å¥ï¼Œå·¥ç¨‹å¸«ï¼æŠ•è³‡è€…è§’åº¦ï¼‰\n  - ä¾†æºï¼ˆå¯é»æ“Šï¼Œé€£åˆ°åŸæ–‡ï¼‰\n- è‹¥å¤šå‰‡æ–°èæè¿°åŒä¸€äº‹ä»¶ï¼Œåªä¿ç•™è³‡è¨Šæœ€å®Œæ•´ã€ä¾†æºæœ€å…·å…¬ä¿¡åŠ›çš„ä¸€å‰‡ã€‚\n\n## ä¸­æ–‡åŒ–è¦å‰‡\n- Email å…§å®¹å¿…é ˆä»¥ä¸­æ–‡å‘ˆç¾ï¼ˆç¹é«”ä¸­æ–‡ zh-Hantï¼‰ã€‚\n- æ¯å‰‡æ–°èçš„ã€Œæ¨™é¡Œã€å¿…é ˆç¿»è­¯æˆä¸­æ–‡ï¼Œä½†é€£çµä»ä½¿ç”¨åŸå§‹ linkã€‚\n- æ¯å‰‡æ–°èçš„ã€Œæ‘˜è¦ã€å¿…é ˆä»¥ä¸­æ–‡æ’°å¯«ï¼Œä¸”åƒ…èƒ½æ ¹æ“š snippet ç¿»è­¯/æ”¹å¯«ï¼Œä¸å¾—åŠ å…¥å¤–éƒ¨è³‡è¨Šã€‚\n- ã€Œç‚ºä½•é‡è¦ã€å¿…é ˆæ˜¯ä¸­æ–‡ã€‚\n- ã€Œä¾†æºã€ç¶­æŒåŸä¾†æºåç¨±ï¼ˆä¾‹å¦‚ Reuters / TechCrunchï¼‰ï¼Œä½†å¿…é ˆæ˜¯å¯é»æ“Šé€£åˆ°åŸæ–‡çš„é€£çµã€‚\n- è‹¥é‡åˆ°å°ˆæœ‰åè©ï¼ˆå…¬å¸åã€äººåã€ç”¢å“åã€åœ°åï¼‰ï¼Œè«‹ä¿ç•™è‹±æ–‡åŸåã€‚\n- ç¦æ­¢è¼¸å‡ºä»»ä½•è‹±æ–‡é•·å¥ï¼›å…è¨±å°‘é‡å°ˆæœ‰åè©è‹±æ–‡ã€‚\n\n## HTML çµæ§‹èˆ‡ç›¸å®¹æ€§\n- ä½¿ç”¨ table + inline CSSã€‚\n- ä¸å¾—ä½¿ç”¨å¤–éƒ¨ CSSã€JavaScriptã€åœ–ç‰‡æˆ–å¤–éƒ¨å­—é«”ã€‚\n- è¼¸å‡ºå¿…é ˆèƒ½åœ¨ Gmailã€Outlookã€Apple Mail æ­£å¸¸é¡¯ç¤ºã€‚\n\n## HTML éª¨æ¶ä½¿ç”¨è¦å‰‡\n- ä½ å¿…é ˆä½¿ç”¨ä½¿ç”¨è€…æä¾›çš„ HTML éª¨æ¶ï¼ˆskeletonï¼‰ä½œç‚ºå›ºå®šçµæ§‹ã€‚\n- ä¸å¾—åˆªé™¤ã€é‡æ’æˆ–ç°¡åŒ–éª¨æ¶ä¸­çš„ HTML çµæ§‹èˆ‡ styleã€‚\n- ä½ åªèƒ½ï¼š\n  - å¡«å…¥å¯¦éš›å…§å®¹\n  - è¤‡è£½ã€Œæ–°èå¡ç‰‡å€å¡Šã€ä»¥å‘ˆç¾å¤šå‰‡æ–°è\n- éª¨æ¶ä¸­çš„ placeholderï¼ˆä¾‹å¦‚ {{date}}ã€{{title}}ã€{{summary}}ã€{{why_it_matters}}ã€{{source}}ã€{{link}}ï¼‰å¿…é ˆä»¥å¯¦éš›å…§å®¹å–ä»£ï¼Œè¼¸å‡ºä¸­ä¸å¾—ä¿ç•™ {{ }}ã€‚\n\n## HTML éª¨æ¶ï¼ˆè«‹ä½¿ç”¨æ­¤çµæ§‹ï¼Œå¡«å…¥å…§å®¹ï¼‰\n\n```html\n<!doctype html>\n<html lang=\"zh-Hant\">\n  <head>\n    <meta charset=\"utf-8\">\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1\">\n    <title>å·¥ç¨‹å¸«æ¯æ—¥æ–°èåŒ¯å ±</title>\n  </head>\n\n  <body style=\"margin:0;padding:0;background-color:#f3f5f9;\">\n    <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\" style=\"background-color:#f3f5f9;\">\n      <tr>\n        <td align=\"center\" style=\"padding:28px 12px;\">\n\n          <!-- Container -->\n          <table role=\"presentation\" width=\"680\" cellpadding=\"0\" cellspacing=\"0\"\n            style=\"width:680px;max-width:680px;background:#ffffff;border-radius:16px;border:1px solid #e4e7ef;\">\n\n            <!-- Header -->\n            <tr>\n              <td style=\"padding:26px 28px;background:#0f172a;\">\n                <div style=\"font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,'Noto Sans TC','PingFang TC','Microsoft JhengHei',sans-serif;color:#ffffff;\">\n                  <div style=\"font-size:20px;font-weight:800;letter-spacing:0.2px;\">\n                    æ—©å®‰ â˜€ï¸ å·¥ç¨‹å¸« Ã— æŠ•è³‡è€…æ¯æ—¥æ–°èåŒ¯å ±\n                  </div>\n                  <div style=\"font-size:13px;opacity:0.8;margin-top:6px;\">\n                    {{ date }}\n                  </div>\n                </div>\n              </td>\n            </tr>\n\n            <!-- Top Takeaways -->\n            <tr>\n              <td style=\"padding:22px 28px 10px 28px;\">\n                <div style=\"font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,'Noto Sans TC','PingFang TC','Microsoft JhengHei',sans-serif;color:#020617;\">\n                  <div style=\"font-size:15px;font-weight:800;margin-bottom:8px;\">\n                    ä»Šæ—¥é‡é»\n                  </div>\n                  <ul style=\"margin:0;padding-left:18px;font-size:14px;line-height:1.7;color:#111827;\">\n                    <li>{{takeaway_1}}</li>\n                    <li>{{takeaway_2}}</li>\n                    <li>{{takeaway_3}}</li>\n                  </ul>\n                </div>\n              </td>\n            </tr>\n\n            <!-- Divider -->\n            <tr>\n              <td style=\"padding:12px 28px;\">\n                <div style=\"height:1px;background:#e5e7eb;\"></div>\n              </td>\n            </tr>\n\n            <!-- SECTION HEADER -->\n            <tr>\n              <td style=\"padding:4px 28px 0 28px;\">\n                <div style=\"font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,'Noto Sans TC','PingFang TC','Microsoft JhengHei',sans-serif;\">\n                  <div style=\"font-size:16px;font-weight:800;color:#020617;border-left:4px solid #2563eb;padding-left:10px;\">\n                    ğŸ§  ç§‘æŠ€\n                  </div>\n                  <div style=\"font-size:12px;color:#6b7280;margin-left:14px;margin-top:4px;\">\n                    AI Â· è³‡å®‰ Â· åŠå°é«” Â· é›²ç«¯ Â· å¤§å‹å¹³å°\n                  </div>\n                </div>\n              </td>\n            </tr>\n\n            <!-- NEWS CARD -->\n            <tr>\n              <td style=\"padding:12px 28px;\">\n                <table role=\"presentation\" width=\"100%\" cellpadding=\"0\" cellspacing=\"0\"\n                  style=\"border:1px solid #e5e7eb;border-radius:14px;\">\n                  <tr>\n                    <td style=\"padding:16px;\">\n                      <div style=\"font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,'Noto Sans TC','PingFang TC','Microsoft JhengHei',sans-serif;\">\n                        <div style=\"font-size:15px;font-weight:800;line-height:1.4;margin-bottom:8px;\">\n                          <a href=\"{{link}}\" target=\"_blank\" rel=\"noopener noreferrer\"\n                             style=\"color:#1d4ed8;text-decoration:none;\">\n                            {{title}}\n                          </a>\n                        </div>\n\n                        <div style=\"font-size:14px;line-height:1.65;color:#111827;margin-bottom:10px;\">\n                          {{summary}}\n                        </div>\n\n                        <div style=\"font-size:14px;line-height:1.65;color:#111827;margin-bottom:10px;\">\n                          <strong>ç‚ºä½•é‡è¦ï¼š</strong>{{why_it_matters}}\n                        </div>\n\n                        <div style=\"font-size:12px;color:#6b7280;\">\n                          ä¾†æºï¼š\n                          <a href=\"{{link}}\" target=\"_blank\" rel=\"noopener noreferrer\"\n                             style=\"color:#2563eb;text-decoration:none;\">\n                            {{source}}\n                          </a>\n                        </div>\n                      </div>\n                    </td>\n                  </tr>\n                </table>\n              </td>\n            </tr>\n            <!-- END CARD -->\n\n            <!-- Footer -->\n            <tr>\n              <td style=\"padding:22px 28px;background:#f8fafc;\">\n                <div style=\"font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Helvetica,Arial,'Noto Sans TC','PingFang TC','Microsoft JhengHei',sans-serif;font-size:12px;line-height:1.6;color:#475569;\">\n                  <strong>èªªæ˜</strong><br>\n                  æœ¬éƒµä»¶ç”±è‡ªå‹•åŒ–å·¥ä½œæµç”¢ç”Ÿï¼Œæ‘˜è¦åƒ…åŸºæ–¼åŸå§‹æ–°è snippetï¼Œè«‹é»æ“Šæ¨™é¡Œé–±è®€å®Œæ•´å…§å®¹ã€‚\n                </div>\n              </td>\n            </tr>\n\n          </table>\n          <!-- /Container -->\n\n        </td>\n      </tr>\n    </table>\n  </body>\n</html>\n```\n\n"
            }
          ]
        },
        "batching": {}
      },
      "type": "@n8n/n8n-nodes-langchain.chainLlm",
      "typeVersion": 1.7,
      "position": [
        1616,
        1136
      ],
      "id": "0edfe0f4-b7c4-4d4f-a08e-d0874155fa54",
      "name": "Basic LLM Chain",
      "retryOnFail": true,
      "waitBetweenTries": 3000,
      "onError": "continueErrorOutput"
    },
    {
      "parameters": {
        "sendTo": "arthur960304@gmail.com, ravenho2021@gmail.com, jinfengqingmai2025@gmail.com, ro5555chenn@gmail.com, dngg6688@gmail.com, sms13366689@gmail.com, dearanita1116@gmail.com",
        "subject": "æ¯æ—¥æ–°èåŒ¯å ±",
        "message": "={{ $json.text }}",
        "options": {
          "appendAttribution": false
        }
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.1,
      "position": [
        2016,
        1056
      ],
      "id": "cd066b85-4f80-4b13-a604-3361a16404b8",
      "name": "SendEmail",
      "webhookId": "42f4f6bd-64dc-4ff4-a551-e10d59160246",
      "credentials": {
        "gmailOAuth2": {
          "id": "JriILMdgCPgFYZHK",
          "name": "Gmail account"
        }
      }
    },
    {
      "parameters": {
        "options": {}
      },
      "type": "@n8n/n8n-nodes-langchain.lmChatGoogleGemini",
      "typeVersion": 1,
      "position": [
        1616,
        1328
      ],
      "id": "7f99f05a-75cc-4ce2-933c-cd52c291bdc3",
      "name": "Google Gemini Chat Model",
      "credentials": {
        "googlePalmApi": {
          "id": "si4tLpXRSst5aHRt",
          "name": "Google Gemini(PaLM) Api account"
        }
      }
    },
    {
      "parameters": {
        "conditions": {
          "options": {
            "caseSensitive": true,
            "leftValue": "",
            "typeValidation": "strict",
            "version": 2
          },
          "conditions": [
            {
              "id": "817c718e-2177-428f-b3f6-ccd0a9f519d5",
              "leftValue": "={{ $json.link }}",
              "rightValue": "news.google.com",
              "operator": {
                "type": "string",
                "operation": "contains"
              }
            }
          ],
          "combinator": "and"
        },
        "options": {}
      },
      "type": "n8n-nodes-base.if",
      "typeVersion": 2.2,
      "position": [
        672,
        912
      ],
      "id": "75b7e5db-8b51-44e0-bb6e-1111adc1d793",
      "name": "If"
    },
    {
      "parameters": {},
      "type": "n8n-nodes-base.merge",
      "typeVersion": 3.2,
      "position": [
        1120,
        1136
      ],
      "id": "e1f6630d-81ee-4fb3-a496-76e84ae8c7a8",
      "name": "Merge"
    },
    {
      "parameters": {
        "assignments": {
          "assignments": [
            {
              "id": "48012e23-86ed-4d37-b613-e76857796ab9",
              "name": "link",
              "value": "={{ $('Get10NewsForEachField').item.json.link }}",
              "type": "string"
            },
            {
              "id": "1a585190-d5f0-4363-a328-5921a31dd3d3",
              "name": "title",
              "value": "={{ $('Get10NewsForEachField').item.json.title }}",
              "type": "string"
            },
            {
              "id": "b7b0e785-d2a7-43a3-ba9b-bab1261ce0bc",
              "name": "content_snippet",
              "value": "={{ $('Get10NewsForEachField').item.json.content_snippet }}",
              "type": "string"
            },
            {
              "id": "689df4ae-725c-44cd-9006-aa4cce448ff0",
              "name": "field",
              "value": "={{ $('Get10NewsForEachField').item.json.field }}",
              "type": "string"
            }
          ]
        },
        "options": {}
      },
      "type": "n8n-nodes-base.set",
      "typeVersion": 3.4,
      "position": [
        896,
        1232
      ],
      "id": "93c88018-f0b9-4162-8599-cbb9db903fdf",
      "name": "SetValues1"
    },
    {
      "parameters": {
        "jsCode": "// Input shape (your previous node):\n// items = [ { json: { data: [ {link,title,content_snippet,field}, ... ] } } ]\n// Output: single item with news_json only\n\nconst TIMEZONE = 'America/Chicago'; // Austin\nconst MAX_SNIPPET_CHARS = 320;\n\nconst fieldOrder = ['tech', 'business', 'finance', 'world_news', 'us_news'];\n\nfunction getSourceFromLink(raw) {\n  if (!raw) return 'unknown';\n\n  let url = String(raw).trim();\n  if (!/^https?:\\/\\//i.test(url)) url = 'https://' + url;\n\n  let host = '';\n  try {\n    host = new URL(url).hostname.replace(/^www\\./, '').toLowerCase();\n  } catch {\n    const m = url.match(/^(?:https?:\\/\\/)?(?:www\\.)?([^\\/\\s?#]+)/i);\n    host = (m && m[1]) ? m[1].toLowerCase() : '';\n  }\n\n  if (!host) return 'unknown';\n\n  const map = {\n    'techcrunch.com': 'TechCrunch',\n    'nasdaq.com': 'Nasdaq',\n    'apnews.com': 'AP News',\n    'reuters.com': 'Reuters',\n    'nytimes.com': 'The New York Times',\n    'wsj.com': 'The Wall Street Journal',\n    'bbc.com': 'BBC',\n    'npr.org': 'NPR',\n    'cnbc.com': 'CNBC',\n    'bloomberg.com': 'Bloomberg',\n    'theguardian.com': 'The Guardian',\n    'axios.com': 'Axios',\n    'ft.com': 'Financial Times',\n    'cnn.com': 'CNN',\n    'investopedia.com': 'Investopedia',\n    'fortune.com': 'Fortune',\n    'seekingalpha.com': 'Seeking Alpha',\n    'marketwatch.com': 'MarketWatch',\n    'yahoo.com': 'Yahoo Finance',\n    'thehill.com': 'The Hill',\n    'washingtonpost.com': 'The Washington Post',\n    'cbsnews.com': 'CBS News',\n    'abcnews.go.com': 'ABC News',\n    'nbcnews.com': 'NBC News',\n    'politico.com': 'Politico',\n  };\n\n  return map[host] || host;\n}\n\nfunction cleanSnippet(s) {\n  if (!s) return '';\n  let t = String(s).replace(/\\s+/g, ' ').trim();\n  if (t.length > MAX_SNIPPET_CHARS) t = t.slice(0, MAX_SNIPPET_CHARS - 1) + 'â€¦';\n  return t;\n}\n\n// 1) Get the list from items[0].json.data\nconst data = items?.[0]?.json?.data;\nif (!Array.isArray(data)) {\n  throw new Error('Expected items[0].json.data to be an array of news items.');\n}\n\n// 2) Normalize\nconst normalized = data.map((n) => ({\n  title: (n.title || '').trim(),\n  link: (n.link || '').trim(),\n  snippet: cleanSnippet(n.content_snippet),\n  field: n.field || 'unknown',\n  source: getSourceFromLink(n.link),\n}));\n\n// 3) Group by field (no limit)\nconst sections = {};\nfor (const f of fieldOrder) sections[f] = [];\n\nfor (const n of normalized) {\n  if (!sections[n.field]) sections[n.field] = [];\n  sections[n.field].push(n);\n}\n\n// 4) Build news_json\nconst now = new Date();\nconst news_json = {\n  date: now.toISOString().slice(0, 10),\n  timezone: TIMEZONE,\n  total_items: normalized.length,\n  sections,\n};\n\n// 5) Return single item for LLM\nreturn [{ json: news_json }];\n"
      },
      "type": "n8n-nodes-base.code",
      "typeVersion": 2,
      "position": [
        1456,
        1136
      ],
      "id": "4f8d15e6-b48a-4836-abff-6047164b29ab",
      "name": "OrganizeData"
    },
    {
      "parameters": {
        "rule": {
          "interval": [
            {
              "triggerAtHour": 9
            }
          ]
        }
      },
      "type": "n8n-nodes-base.scheduleTrigger",
      "typeVersion": 1.3,
      "position": [
        -320,
        384
      ],
      "id": "8841fabf-1f73-4d72-a6b2-55226a08d1ab",
      "name": "Schedule Trigger"
    },
    {
      "parameters": {
        "sendTo": "arthur960304@gmail.com",
        "subject": "æ¯æ—¥æ–°èåŒ¯å ±å¤±æ•—é€šçŸ¥",
        "message": "<!doctype html>\n\n<html lang=\"zh-Hant\">\n  <head>\n    <meta charset=\"utf-8\" />\n  </head>\n  <body style=\"margin:0;padding:0;background:#f6f7fb;font-family:-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,'Noto Sans TC','PingFang TC','Microsoft JhengHei',sans-serif;color:#111827;\">\n    <div style=\"max-width:520px;margin:40px auto;padding:24px;\">\n      <div style=\"background:#ffffff;border:1px solid #e5e7eb;border-radius:12px;padding:24px;\">\n        <h2 style=\"margin:0 0 12px 0;font-size:18px;\">\n          âŒ æ¯æ—¥æ–°èåŒ¯å ±å¤±æ•—\n        </h2>\n        <p style=\"margin:0;font-size:14px;line-height:1.6;color:#374151;\">\n          n8n åœ¨åŸ·è¡Œ <strong>æ¯æ—¥æ–°èåŒ¯å ±</strong> æ™‚ç™¼ç”ŸéŒ¯èª¤ï¼Œ  \n          Basic LLM Chain æœªèƒ½æˆåŠŸå®Œæˆæµç¨‹ï¼Œå› æ­¤æœ¬æ¬¡æ–°èæœªå¯„é€ã€‚\n          \n          è«‹ç™»å…¥ n8n æª¢æŸ¥å·¥ä½œæµç‹€æ…‹ã€‚\n        </p>\n  </div>\n</div>\n\n  </body>\n</html>\n",
        "options": {}
      },
      "type": "n8n-nodes-base.gmail",
      "typeVersion": 2.2,
      "position": [
        2016,
        1232
      ],
      "id": "64c5023c-77d8-4f98-93e6-7cbdbd21e084",
      "name": "SendErrorMsg",
      "webhookId": "f0efec53-d996-453c-befe-fe0cf22038ab",
      "credentials": {
        "gmailOAuth2": {
          "id": "JriILMdgCPgFYZHK",
          "name": "Gmail account"
        }
      }
    }
  ],
  "pinData": {},
  "settings": {
    "executionOrder": "v1"
  },
  "shared": [
    {
      "updatedAt": "2025-12-17T21:16:44.965Z",
      "createdAt": "2025-12-17T21:16:44.965Z",
      "role": "workflow:owner",
      "workflowId": "7hJz5eQk12axtKwc",
      "projectId": "bK0jph6zkEPxu4nf",
      "project": {
        "updatedAt": "2025-12-17T20:49:45.388Z",
        "createdAt": "2025-12-17T20:44:46.306Z",
        "id": "bK0jph6zkEPxu4nf",
        "name": "Arthur Hsieh <arthur960304@gmail.com>",
        "type": "personal",
        "icon": null,
        "description": null,
        "creatorId": "049de407-c1f1-4531-9508-8d3d2d1d1297",
        "projectRelations": [
          {
            "updatedAt": "2025-12-17T20:44:46.306Z",
            "createdAt": "2025-12-17T20:44:46.306Z",
            "userId": "049de407-c1f1-4531-9508-8d3d2d1d1297",
            "projectId": "bK0jph6zkEPxu4nf",
            "user": {
              "updatedAt": "2026-01-19T14:09:32.168Z",
              "createdAt": "2025-12-17T20:44:15.006Z",
              "id": "049de407-c1f1-4531-9508-8d3d2d1d1297",
              "email": "arthur960304@gmail.com",
              "firstName": "Arthur",
              "lastName": "Hsieh",
              "personalizationAnswers": {
                "version": "v4",
                "personalization_survey_submitted_at": "2025-12-17T20:50:00.520Z",
                "personalization_survey_n8n_version": "2.0.2",
                "companyType": "personal",
                "reportedSource": "google"
              },
              "settings": {
                "userActivated": true,
                "easyAIWorkflowOnboarded": true,
                "firstSuccessfulWorkflowId": "7hJz5eQk12axtKwc",
                "userActivatedAt": 1766242805704,
                "npsSurvey": {
                  "responded": true,
                  "lastShownAt": 1767285413604
                }
              },
              "disabled": false,
              "mfaEnabled": false,
              "lastActiveAt": "2026-01-19",
              "isPending": false
            }
          }
        ]
      }
    }
  ],
  "staticData": {
    "node:Schedule Trigger": {
      "recurrenceRules": []
    }
  },
  "tags": [],
  "triggerCount": 1,
  "updatedAt": "2026-01-01T19:06:13.637Z",
  "versionCounter": 49,
  "versionId": "0f6a0b2a-e370-41bf-9801-154699ad2d06"
}